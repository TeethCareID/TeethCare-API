## Router 1
enable
configure terminal
interface FastEthernet0/0
no shutdown
interface FastEthernet0/0.10
encapsulation dot1q 10
ip address 192.168.2.1 255.255.255.0

ip dhcp pool iptelepon
network 192.168.2.0 255.255.255.0
default-router 192.168.2.1
option 150 ip 192.168.2.1

telephony-service
ip source-address 192.168.2.1 port 2000
max-dn 2
max-ephone 2
auto assign 1 to 2
ephone-dn 1
number 1001
ephone-dn 2
number 1002

enable
configure terminal
interface se0/3/0
ip address 10.10.10.1 255.255.255.0
no shutdown
interface se0/3/1
ip address 13.13.13.1 255.255.255.0
no shutdown
exit


ip route 11.11.11.0 255.255.255.0 10.10.10.2
ip route 12.12.12.0 255.255.255.0 10.10.10.2

dial-peer voice 1 voip
session target ipv4:10.10.10.2
destination-pattern 300. 
exit

dial-peer voice 2 voip
session target ipv4:12.12.12.2
destination-pattern 200. 
exit

dial-peer voice 3 voip
session target ipv4:11.11.11.1
destination-pattern 400. 
exit

## Router 2
enable
configure terminal
interface FastEthernet0/0
no shutdown
interface FastEthernet0/0.10
encapsulation dot1q 10
ip address 192.168.1.1 255.255.255.0

ip dhcp pool iptelepon
network 192.168.1.0 255.255.255.0
default-router 192.168.1.1
option 150 ip 192.168.1.1

telephony-service
ip source-address 192.168.1.1 port 2000
max-dn 2
max-ephone 2
auto assign 1 to 2
ephone-dn 1
number 2001
ephone-dn 2
number 2002

enable
configure terminal
interface se0/3/0
ip address 12.12.12.2 255.255.255.0
no shutdown
interface se0/3/1
ip address 13.13.13.2 255.255.255.0
no shutdown
exit


ip route 11.11.11.0 255.255.255.0 12.12.12.1
ip route 10.10.10.0 255.255.255.0 12.12.12.1

dial-peer voice 1 voip
session target ipv4:10.10.10.1
destination-pattern 100. 
exit

dial-peer voice 2 voip
session target ipv4:11.11.11.2
destination-pattern 300. 
exit

dial-peer voice 3 voip
session target ipv4:12.12.12.1
destination-pattern 400. 
exit




### Router 3
enable
configure terminal
interface FastEthernet0/0
no shutdown
interface FastEthernet0/0.10
encapsulation dot1q 10
ip address 192.168.3.1 255.255.255.0

ip dhcp pool iptelepon
network 192.168.3.0 255.255.255.0
default-router 192.168.3.1
option 150 ip 192.168.3.1

telephony-service
ip source-address 192.168.3.1 port 2000
max-dn 2
max-ephone 2
auto assign 1 to 2
ephone-dn 1
number 3001
ephone-dn 2
number 3002

enable
configure terminal
interface se0/3/0
ip address 10.10.10.2 255.255.255.0
no shutdown
interface se0/3/1
ip address 11.11.11.2 255.255.255.0
no shutdown
exit


ip route 12.12.12.0 255.255.255.0 11.11.11.1

dial-peer voice 1 voip
session target ipv4:10.10.10.1
destination-pattern 100. 
exit

dial-peer voice 2 voip
session target ipv4:11.11.11.1
destination-pattern 400. 
exit

dial-peer voice 3 voip
session target ipv4:12.12.12.2
destination-pattern 200. 
exit




## Router 4
enable
configure terminal
interface FastEthernet0/0
no shutdown
interface FastEthernet0/0.10
encapsulation dot1q 10
ip address 192.168.4.1 255.255.255.0

ip dhcp pool iptelepon
network 192.168.4.0 255.255.255.0
default-router 192.168.4.1
option 150 ip 192.168.4.1

telephony-service
ip source-address 192.168.4.1 port 2000
max-dn 2
max-ephone 2
auto assign 1 to 2
ephone-dn 1
number 4001
ephone-dn 2
number 4002

enable
configure terminal
interface se0/3/0
ip address 12.12.12.1 255.255.255.0
no shutdown
interface se0/3/1
ip address 11.11.11.1 255.255.255.0
no shutdown
exit


ip route 10.10.10.0 255.255.255.0 11.11.11.2

dial-peer voice 1 voip
session target ipv4:10.10.10.1
destination-pattern 100. 
exit

dial-peer voice 2 voip
session target ipv4:11.11.11.2
destination-pattern 300. 
exit

dial-peer voice 3 voip
session target ipv4:12.12.12.2
destination-pattern 200. 
exit


## Switch 1-4
enable
configure terminal
vlan 10
interface FastEthernet0/1
switchport mode trunk
interface range FastEthernet0/2-4
switchport voice vlan 10

